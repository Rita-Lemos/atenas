{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\laravel-base\\\\src\\\\views\\\\SearchView.js\";\n//Pesquisa e depois logo se vê\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport '../css/searchview.css';\nimport axios from 'axios';\nimport Card from \"react-bootstrap/Card\";\nimport '../css/personalizationview.css';\nimport '../css/personalizationgrid.css';\nimport recombee from 'recombee-js-api-client';\n\nclass SearchView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userInput: '',\n      news: [],\n      cor: 0\n    };\n    this.handleUserInput = this.handleUserInput.bind(this);\n    this.handleClicka = this.handleClicka.bind(this);\n    this.handleSendToLink = this.handleSendToLink.bind(this);\n  }\n\n  handleUserInput(e) {\n    this.setState({\n      userInput: e.target.value\n    });\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    console.log('Mounted', this._isMounted);\n\n    if (this._isMounted) {\n      Promise.all([axios('api/newsAll/' + localStorage.getItem('user'))]).then(([res1]) => {\n        return Promise.all([res1]);\n      }).then(([res1]) => {\n        console.log(res1);\n        this.setState({\n          isLoaded: true,\n          news: res1.data.data\n        });\n      });\n    }\n  }\n\n  handleClicka(event) {\n    console.log('here-->', event);\n    const noticiaEspecial = event.id;\n    const myUser = localStorage.getItem('user');\n\n    if (event.guardado && event.guardado.length) {\n      //noticia pertence aos guardados, tem de ser removida\n      axios.delete('api/newsUser/' + event.guardado[0].id).then(res => {\n        console.log(res.data);\n        console.log('apagar noticia');\n        this.componentDidMount();\n      });\n    } else {\n      console.log('vais guardar a noticia e apresentar a div!');\n      var client = new recombee.ApiClient('atenas-atenas-final', 'cuXTbNwBbReV9FcCwC05qLaJ73lIUjmXqgw6kXU2Mo2rGTfuepGuEmrpuaC2xiG4');\n      axios.post('api/newsUser', {\n        news_id: event.id,\n        user_id: myUser,\n        collection_id: 1\n      }).then(response => {\n        console.log('resposta:', response); // 2. ir para o sistema de recomendação, em que vai o userID e o nome da notícia\n\n        client.send(new recombee.AddCartAddition(myUser, event.id, {\n          'cascadeCreate': true\n        })).then(res => {\n          console.log(res); //window.location.href='';\n\n          this.setState({\n            aviso: 'Notícia guardada com sucesso',\n            arcozelo: React.createElement(\"div\", {\n              className: \"a_divNoticiaGuardada\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 84\n              },\n              __self: this\n            }, \"Not\\xEDcia guardada com sucesso\")\n          }); // window.alert('Notícia Guardada');\n\n          setTimeout(function () {\n            this.setState({\n              arcozelo: React.createElement(\"div\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 88\n                },\n                __self: this\n              })\n            });\n            this.componentDidMount();\n          }.bind(this), 2000);\n        });\n        console.log('Item adicionado ao carrinho| Notícia está no recomendador guardados');\n      }).catch(error => {\n        console.log('erro: ', error.response);\n      });\n    }\n  }\n\n  handleSendToLink(event) {\n    const userEu = localStorage.getItem('user');\n    const noticiaId = event.id;\n    var client = new recombee.ApiClient('atenas-atenas-novo', '61Z8UGxxGFlTmuMtE3uUixd0ofZIlefQk68LTUXd2pzExiDtTgUOhSffYoUFmLQB');\n    console.log(noticiaId, '--> vai ser a noticia');\n    console.log(userEu, '--> vai ser o user');\n    console.log(event, '--> evento');\n    client.send(new recombee.AddPurchase(userEu, noticiaId, {\n      'cascadeCreate': true\n    })).then(res => {\n      console.log(res);\n      console.log('Noticia Visitada --> Compra feita'); //window.location.href = event.url;\n    });\n  }\n\n  render() {\n    // if(localStorage.getItem('user')==null) {\n    //     return <Redirect to='/session' />;\n    // }\n    var _this$state = this.state,\n        isLoaded = _this$state.isLoaded,\n        news = _this$state.news,\n        news_topics = _this$state.news_topics,\n        topics = _this$state.topics,\n        guardados = _this$state.guardados;\n    console.log(this.state.userInput);\n\n    if (!isLoaded) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"Loading...\");\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }), this.state.arcozelo, React.createElement(\"div\", {\n        className: \"a_searchview_bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        size: \"25\",\n        className: \"a_searchview_input\",\n        placeholder: \"Pesquisar...\",\n        onChange: this.handleUserInput,\n        value: this.state.userInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }), React.createElement(\"a\", {\n        href: \"/commingsoon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"a_searchview_icons\",\n        src: require('../images/photo.svg'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      })), React.createElement(\"a\", {\n        href: \"/commingsoon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"a_searchview_icons\",\n        src: require('../images/micro.svg'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      })), React.createElement(\"a\", {\n        href: \"/main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"a_searchview_icons a_searchviewclose\",\n        src: require('../images/closegray.svg'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }))), this.state.news.map(value => {\n        let src = \"http://atenas.hopto.org/uploads/\" + value.image;\n        let cor = \"\";\n\n        if (value.guardado && value.guardado.length) {\n          cor = \"guardados_vermelho_preenchido.svg\";\n        } else {\n          cor = \"guardados_vermelho_contorno.svg\";\n        }\n\n        console.log('valorzinho', value);\n        var pesquisa = value.title.includes(this.state.userInput);\n        console.log('aparece', pesquisa);\n        console.log('funciona rapidooo', this.state.userInput);\n        console.log('noticia', value.title);\n\n        if (pesquisa == true) {\n          return React.createElement(\"div\", {\n            className: \"col-sm-4 a_list_margem\",\n            key: value.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 174\n            },\n            __self: this\n          }, React.createElement(Card, {\n            className: \"a_list_change_card\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176\n            },\n            __self: this\n          }, React.createElement(\"a\", {\n            className: \"linksList\",\n            onClick: () => {\n              this.handleSendToLink(value);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 177\n            },\n            __self: this\n          }, React.createElement(Card.Header, {\n            className: \"a_list_news \",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }, value.topicoNoticia), React.createElement(Card.Body, {\n            className: \"a_list_change_body\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"a_divImageNoticia\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            className: \"a_list_radius\",\n            src: src,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          })), React.createElement(Card.Title, {\n            className: \"a_list_margin_title\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"a_list_titulos\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186\n            },\n            __self: this\n          }, value.title)))), React.createElement(\"div\", {\n            className: \"btnGuardaList\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 192\n            },\n            __self: this\n          }, React.createElement(\"a\", {\n            type: \"button\",\n            className: \"a_list_position_news\",\n            onClick: () => {\n              this.handleClicka(value);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 193\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            className: \"a_list_img_guardados\",\n            src: require(`../images/` + cor),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 194\n            },\n            __self: this\n          })))));\n        }\n      }));\n    }\n  }\n\n}\n\nexport default SearchView;","map":{"version":3,"sources":["C:/xampp/htdocs/laravel-base/src/views/SearchView.js"],"names":["React","Component","Redirect","axios","Card","recombee","SearchView","constructor","props","state","userInput","news","cor","handleUserInput","bind","handleClicka","handleSendToLink","e","setState","target","value","componentDidMount","_isMounted","console","log","Promise","all","localStorage","getItem","then","res1","isLoaded","data","event","noticiaEspecial","id","myUser","guardado","length","delete","res","client","ApiClient","post","news_id","user_id","collection_id","response","send","AddCartAddition","aviso","arcozelo","setTimeout","catch","error","userEu","noticiaId","AddPurchase","render","news_topics","topics","guardados","require","map","src","image","pesquisa","title","includes","topicoNoticia"],"mappings":"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","sourcesContent":["//Pesquisa e depois logo se vê\r\nimport React, {Component} from 'react'\r\nimport {Redirect} from 'react-router-dom';\r\nimport '../css/searchview.css';\r\nimport axios from 'axios';\r\nimport Card from \"react-bootstrap/Card\";\r\nimport '../css/personalizationview.css';\r\nimport '../css/personalizationgrid.css';\r\nimport recombee from 'recombee-js-api-client';\r\n\r\n\r\nclass SearchView extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {userInput: '', news: [], cor: 0};\r\n\r\n        this.handleUserInput = this.handleUserInput.bind(this);\r\n        this.handleClicka = this.handleClicka.bind(this);\r\n        this.handleSendToLink=this.handleSendToLink.bind(this);\r\n    }\r\n\r\n    handleUserInput(e) {\r\n        this.setState({userInput: e.target.value});\r\n    }\r\n\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n        console.log('Mounted', this._isMounted);\r\n        if (this._isMounted) {\r\n            Promise.all([axios('api/newsAll/' + localStorage.getItem('user'))])\r\n\r\n                .then(([res1]) => {\r\n                    return Promise.all([res1])\r\n                })\r\n\r\n                .then(([res1]) => {\r\n                    console.log(res1);\r\n\r\n                    this.setState({\r\n                        isLoaded: true,\r\n                        news: res1.data.data,\r\n                    })\r\n                });\r\n        }\r\n    }\r\n\r\n    handleClicka(event){\r\n        console.log('here-->',event);\r\n\r\n        const noticiaEspecial=event.id;\r\n        const myUser=localStorage.getItem('user');\r\n        if(event.guardado && event.guardado.length){\r\n            //noticia pertence aos guardados, tem de ser removida\r\n            axios.delete('api/newsUser/'+event.guardado[0].id)\r\n                .then(res => {\r\n                    console.log(res.data);\r\n                    console.log('apagar noticia');\r\n                    this.componentDidMount();\r\n                })\r\n        }else{\r\n            console.log('vais guardar a noticia e apresentar a div!');\r\n            var client = new recombee.ApiClient('atenas-atenas-final', 'cuXTbNwBbReV9FcCwC05qLaJ73lIUjmXqgw6kXU2Mo2rGTfuepGuEmrpuaC2xiG4');\r\n\r\n            axios.post('api/newsUser', {\r\n                news_id: event.id,\r\n                user_id: myUser,\r\n                collection_id: 1\r\n            })\r\n                .then(response => {\r\n                    console.log('resposta:', response);\r\n\r\n                    // 2. ir para o sistema de recomendação, em que vai o userID e o nome da notícia\r\n                    client.send(new recombee.AddCartAddition(\r\n                        myUser,\r\n                        event.id,\r\n                        {\r\n                            'cascadeCreate': true\r\n                        })).then(res => {\r\n                        console.log(res);\r\n                        //window.location.href='';\r\n                        this.setState({\r\n                            aviso: 'Notícia guardada com sucesso',\r\n                            arcozelo: <div className='a_divNoticiaGuardada'>Notícia guardada com sucesso</div>\r\n                        });\r\n                        // window.alert('Notícia Guardada');\r\n                        setTimeout(function(){\r\n                            this.setState({arcozelo:<div></div>});\r\n                            this.componentDidMount()\r\n                        }.bind(this),2000);\r\n\r\n\r\n                    });\r\n                    console.log('Item adicionado ao carrinho| Notícia está no recomendador guardados');\r\n                })\r\n                .catch(error => {\r\n                    console.log('erro: ', error.response);\r\n                });\r\n        }\r\n    }\r\n\r\n    handleSendToLink(event) {\r\n        const userEu = localStorage.getItem('user');\r\n        const noticiaId = event.id;\r\n        var client = new recombee.ApiClient('atenas-atenas-novo', '61Z8UGxxGFlTmuMtE3uUixd0ofZIlefQk68LTUXd2pzExiDtTgUOhSffYoUFmLQB');\r\n\r\n        console.log(noticiaId, '--> vai ser a noticia');\r\n        console.log(userEu, '--> vai ser o user');\r\n        console.log(event, '--> evento');\r\n\r\n        client.send(new recombee.AddPurchase(\r\n            userEu,\r\n            noticiaId,\r\n            {\r\n                'cascadeCreate': true\r\n            }))\r\n            .then(res => {\r\n                console.log(res);\r\n                console.log('Noticia Visitada --> Compra feita');\r\n                //window.location.href = event.url;\r\n            });\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n        // if(localStorage.getItem('user')==null) {\r\n        //     return <Redirect to='/session' />;\r\n        // }\r\n        var {isLoaded, news, news_topics, topics, guardados} = this.state;\r\n\r\n\r\n        console.log(this.state.userInput);\r\n\r\n        if (!isLoaded) {\r\n            return <div>Loading...</div>\r\n        } else {\r\n\r\n\r\n            return (\r\n\r\n                <div>\r\n                  \r\n                    <br/>\r\n                    {this.state.arcozelo}\r\n                        <div className=\"a_searchview_bar\">\r\n                            <input size=\"25\" className=\"a_searchview_input\" placeholder=\"Pesquisar...\"\r\n                                   onChange={this.handleUserInput} value={this.state.userInput}></input>\r\n                            <a href=\"/commingsoon\"><img className=\"a_searchview_icons\"\r\n                                                        src={require('../images/photo.svg')}/></a>\r\n                            <a href=\"/commingsoon\"><img className=\"a_searchview_icons\"\r\n                                                        src={require('../images/micro.svg')}/></a>\r\n                            <a href=\"/main\"><img className=\"a_searchview_icons a_searchviewclose\"\r\n                                                 src={require('../images/closegray.svg')}/></a>\r\n                        </div>\r\n\r\n                    {this.state.news.map((value) => {\r\n                        let src = \"http://atenas.hopto.org/uploads/\" + value.image;\r\n                        let cor = \"\";\r\n                        if (value.guardado && value.guardado.length) {\r\n                            cor = \"guardados_vermelho_preenchido.svg\"\r\n                        } else {\r\n                            cor =\"guardados_vermelho_contorno.svg\";\r\n                        }\r\n                        console.log('valorzinho', value);\r\n\r\n                        var pesquisa = value.title.includes(this.state.userInput);\r\n                        console.log('aparece', pesquisa);\r\n                        console.log('funciona rapidooo', this.state.userInput);\r\n                        console.log('noticia', value.title);\r\n\r\n                        if (pesquisa == true) {\r\n                            return (\r\n                                <div className='col-sm-4 a_list_margem' key={value.id}>\r\n\r\n                                    <Card className='a_list_change_card'>\r\n                                        <a className=\"linksList\" onClick={()=>{this.handleSendToLink(value)}}>\r\n                                            <Card.Header className='a_list_news '>{value.topicoNoticia}</Card.Header>\r\n                                            <Card.Body className='a_list_change_body'>\r\n                                                <div className=\"a_divImageNoticia\">\r\n\r\n                                                    <img className='a_list_radius'\r\n                                                         src={src}/>\r\n                                                </div>\r\n                                                <Card.Title className='a_list_margin_title'>\r\n                                                    <div className='a_list_titulos'>{value.title}</div>\r\n                                                </Card.Title>\r\n                                            </Card.Body>\r\n                                        </a>\r\n\r\n\r\n                                        <div className=\"btnGuardaList\">\r\n                                            <a type='button' className='a_list_position_news' onClick={()=>{this.handleClicka(value)}}>\r\n                                                <img className='a_list_img_guardados' src={require(`../images/` + cor)}/>\r\n                                            </a>\r\n                                        </div>\r\n\r\n\r\n                                    </Card>\r\n\r\n                                </div>\r\n                            )\r\n                        }\r\n\r\n\r\n                    })\r\n                    }\r\n                </div>\r\n\r\n\r\n            )\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport default SearchView;\r\n"]},"metadata":{},"sourceType":"module"}